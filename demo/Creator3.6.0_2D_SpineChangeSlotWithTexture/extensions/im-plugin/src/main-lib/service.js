const _0x39fc=['sessionCode','get\x20session\x20failed','requestService','instance','data','getInstance','cleanImSetting','getSessionToken','default','getUserData','then','getImSetting','https://creator-api.cocos.com/api','indexOf','user_licnese','I18n','/service/get_im_setting','/session/token','getSessionCode','User','init','shouldShowEntrance','__esModule','sessionId','isVip','postData','getSignInUrl','getRedirectUrl','getNewMsgCount','session_id','encodeParams','&redirect_url=','show_entrance','defineProperty','remote','sessionToken','sessionChanged','/account/client_signin?session_id=','error','lang=','getLanguage','init\x20failed,\x20cannot\x20get\x20session\x20id'];(function(_0x26e799,_0x175533){const _0x39fc8e=function(_0x347959){while(--_0x347959){_0x26e799['push'](_0x26e799['shift']());}};_0x39fc8e(++_0x175533);}(_0x39fc,0xe1));const _0x3479=function(_0x26e799,_0x175533){_0x26e799=_0x26e799-0xcf;let _0x39fc8e=_0x39fc[_0x26e799];return _0x39fc8e;};const _0xe28eab=_0x3479;'use strict';Object[_0xe28eab(0xe1)](exports,_0xe28eab(0xd6),{'value':!0x0});const http_utils_1=require('./http-utils'),apiBaseUrl=_0xe28eab(0xf6);class Service{constructor(){const _0x2124d4=_0xe28eab;this[_0x2124d4(0xd7)]=null,this[_0x2124d4(0xea)]=null,this[_0x2124d4(0xe3)]=null,this['imSetting']=null;}static async[_0xe28eab(0xef)](){const _0x1b9d04=_0xe28eab;if(Service[_0x1b9d04(0xed)]&&!await Service[_0x1b9d04(0xed)]['sessionChanged']())return Service[_0x1b9d04(0xed)];const _0x2e3047=new Service();return await _0x2e3047[_0x1b9d04(0xd4)](),Service[_0x1b9d04(0xed)]=_0x2e3047,_0x2e3047;}async[_0xe28eab(0xe4)](){const _0x59d83f=_0xe28eab;return(await this[_0x59d83f(0xf3)]())[_0x59d83f(0xdd)]!==this[_0x59d83f(0xd7)];}async['getUserData'](){const _0x1f1864=_0xe28eab;let _0x3a1214=null;return _0x3a1214=Editor['User']['getData'](),_0x3a1214[_0x1f1864(0xf4)]||(_0x3a1214=Editor[_0x1f1864(0xe2)][_0x1f1864(0xd3)]['getData']()),_0x3a1214;}async[_0xe28eab(0xd4)](){const _0x236ee1=_0xe28eab,_0x50a95e=await this[_0x236ee1(0xf3)]();if(this['sessionId']=_0x50a95e['session_id'],this[_0x236ee1(0xd7)])try{this[_0x236ee1(0xea)]=await this['getSessionCode'](this[_0x236ee1(0xd7)]),this[_0x236ee1(0xe3)]=await this[_0x236ee1(0xf1)](this['sessionCode']);}catch(_0x386fc0){console[_0x236ee1(0xe6)](_0x236ee1(0xeb)),console['error'](_0x386fc0);}else console[_0x236ee1(0xe6)](_0x236ee1(0xe9));}async[_0xe28eab(0xf5)](){const _0x259477=_0xe28eab;try{const _0x234702=await this[_0x259477(0xec)](apiBaseUrl+_0x259477(0xd0),{'session_token':this[_0x259477(0xe3)]});return this['imSetting']=_0x234702[_0x259477(0xee)],_0x234702[_0x259477(0xee)];}catch(_0x16025d){return null;}}[_0xe28eab(0xf0)](){this['imSetting']=null;}async['getButtonTitle'](){const _0x1dfba0=await this['getImSetting']();return _0x1dfba0?_0x1dfba0['button_title']:'';}async[_0xe28eab(0xd8)](){const _0x128634=_0xe28eab,_0x19575e=await this[_0x128634(0xf5)]();return!!_0x19575e&&!!_0x19575e[_0x128634(0xf8)];}async[_0xe28eab(0xdc)](){const _0x43f00f=_0xe28eab,_0x5dbc77=await this[_0x43f00f(0xf5)]();if(!_0x5dbc77)return 0x0;try{const _0x2cd85f=await http_utils_1[_0x43f00f(0xd9)](_0x5dbc77['msg_api_url']);return _0x2cd85f[_0x43f00f(0xee)]?_0x2cd85f[_0x43f00f(0xee)]:0x0;}catch(_0x1169ac){return 0x0;}}async[_0xe28eab(0xd5)](){const _0x165cf5=_0xe28eab,_0xfe484c=await this[_0x165cf5(0xf5)]();return!!_0xfe484c&&!!_0xfe484c[_0x165cf5(0xe0)];}async[_0xe28eab(0xda)](){const _0x47e84e=_0xe28eab,_0x39b6cb=await this['getImSetting']();return _0x39b6cb?this[_0x47e84e(0xdb)](_0x39b6cb['entry_url']):null;}[_0xe28eab(0xdb)](_0x1331f5){const _0x3a6a1b=_0xe28eab,_0x1f5d4d=_0x1331f5+(_0x1331f5[_0x3a6a1b(0xf7)]('?')>=0x0?'&':'?')+(_0x3a6a1b(0xe7)+Editor[_0x3a6a1b(0xcf)][_0x3a6a1b(0xe8)]());return apiBaseUrl+_0x3a6a1b(0xe5)+this[_0x3a6a1b(0xd7)]+_0x3a6a1b(0xdf)+encodeURIComponent(_0x1f5d4d);}async[_0xe28eab(0xd2)](_0x50404f){const _0x56a7bd=_0xe28eab;return(await this[_0x56a7bd(0xec)](apiBaseUrl+'/session/code',{'session_id':_0x50404f}))[_0x56a7bd(0xee)]['session_code'];}async[_0xe28eab(0xf1)](_0x4a680c){const _0x1992e4=_0xe28eab;return(await this['requestService'](apiBaseUrl+_0x1992e4(0xd1),{'session_code':_0x4a680c}))['data']['session_token'];}async[_0xe28eab(0xec)](_0x2ee8ef,_0x40c22e){const _0xed7e9c=_0xe28eab;return http_utils_1[_0xed7e9c(0xd9)](_0x2ee8ef,http_utils_1[_0xed7e9c(0xde)](_0x40c22e));}}exports[_0xe28eab(0xf2)]=Service,Service[_0xe28eab(0xed)]=null;