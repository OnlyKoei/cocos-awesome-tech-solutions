const _0x39ab=['./host-api.js','image','dom-ready','defineProperty','info-title','save-file','silent-check-and-update','panels','get-data','type','get-redirect-url','env','close-panel','ready','channel','request','downloadProgress','dayjs/plugin/utc','canceled','url','style','dayjs','save-image','gif','extend','__esModule','ipcRenderer','percent','download-canceled',':force-close-panel','image-filter-name','block','info-non-logged-in','close','callId','send','electron','default','download-with-progress','file-selected','basename','update-btn','src','filePaths','length','broadcast','select-file','filePath',':get-version','update','getLanguage','addBroadcastListener','./style.css','join','@base/electron-windows/package.json','beforeClose','update-toolbar','getTimezoneOffset','click','select-image','App','dayjs/plugin/timezone','download','path','silent-check','select','download-succeeded','dirname','newMsgCount','preload','transferred','is-ready','release','info','utf8','args','save',':panel-win-state-changed','download-progress','readFileSync','methods','none','total',':close','guess','get-sign-in-url','name','jpeg','png','addEventListener','updateBtn','paths','im-plugin','innerText','template','jpg','removeEventListener','../../common-lib/dialog','Message','push','fileName','refresh','setAttribute','file-filter-name','removeBroadcastListener','get-sign-in-url-failed','I18n','display','assign','webview','#loading-page','#btn-4','isLoggedIn','./node_modules'];(function(_0x995b4,_0x7c1030){const _0x39ab07=function(_0x5050ec){while(--_0x5050ec){_0x995b4['push'](_0x995b4['shift']());}};_0x39ab07(++_0x7c1030);}(_0x39ab,0x178));const _0x5050=function(_0x995b4,_0x7c1030){_0x995b4=_0x995b4-0x1aa;let _0x39ab07=_0x39ab[_0x995b4];return _0x39ab07;};const _0x4e8e4a=_0x5050;'use strict';var __importDefault=this&&this['__importDefault']||function(_0x203683){const _0x34f6e1=_0x5050;return _0x203683&&_0x203683[_0x34f6e1(0x213)]?_0x203683:{'default':_0x203683};};Object[_0x4e8e4a(0x1fd)](exports,'__esModule',{'value':!0x0}),exports[_0x4e8e4a(0x1d8)]=exports[_0x4e8e4a(0x21b)]=exports[_0x4e8e4a(0x1bf)]=exports[_0x4e8e4a(0x207)]=exports['$']=exports[_0x4e8e4a(0x20e)]=exports[_0x4e8e4a(0x1e6)]=void 0x0;const path_1=__importDefault(require(_0x4e8e4a(0x1c7))),fs_1=__importDefault(require('fs')),electron_1=require(_0x4e8e4a(0x1ac)),download_1=__importDefault(require(_0x4e8e4a(0x1c6))),file_url_1=__importDefault(require('file-url')),translate_1=require('../../common-lib/translate'),dialog_1=require(_0x4e8e4a(0x1e9)),namespace_1=require('../../constant/namespace'),os_1=__importDefault(require('os')),pluginVersion=electron_1[_0x4e8e4a(0x214)]['sendSync'](namespace_1['ns']+_0x4e8e4a(0x1b8));var utc=require(_0x4e8e4a(0x20b)),timezone=require(_0x4e8e4a(0x1c5)),dayjs=require(_0x4e8e4a(0x20f));dayjs[_0x4e8e4a(0x212)](utc),dayjs[_0x4e8e4a(0x212)](timezone),module[_0x4e8e4a(0x1e3)][_0x4e8e4a(0x1eb)](path_1[_0x4e8e4a(0x1ad)][_0x4e8e4a(0x1bd)](Editor['App'][_0x4e8e4a(0x1c7)],_0x4e8e4a(0x1f9)));const element=require('@editor/panel/lib/element'),windowsPkg=require(_0x4e8e4a(0x1be)),ipcFlag=windowsPkg[_0x4e8e4a(0x1de)]+'@'+windowsPkg['version'];let forceClose=!0x1;const template=fs_1[_0x4e8e4a(0x1ad)][_0x4e8e4a(0x1d7)](path_1[_0x4e8e4a(0x1ad)][_0x4e8e4a(0x1bd)](__dirname,'./index.html'),_0x4e8e4a(0x1d2));exports[_0x4e8e4a(0x1e6)]=template;const style=fs_1['default'][_0x4e8e4a(0x1d7)](path_1[_0x4e8e4a(0x1ad)][_0x4e8e4a(0x1bd)](__dirname,_0x4e8e4a(0x1bc)),_0x4e8e4a(0x1d2));exports[_0x4e8e4a(0x20e)]=style;const selector={'webview':'#webview','loadingPage':_0x4e8e4a(0x1f6),'updateBtn':_0x4e8e4a(0x1f7)};exports['$']=selector;let action=_0x4e8e4a(0x1ed);async function controlUpdateBtn(_0x1945e7){const _0x4f3ed8=_0x4e8e4a;await Editor[_0x4f3ed8(0x1ea)][_0x4f3ed8(0x209)](_0x4f3ed8(0x1e4),_0x4f3ed8(0x1c8))?(_0x1945e7['$']['updateBtn'][_0x4f3ed8(0x20e)][_0x4f3ed8(0x1f3)]=_0x4f3ed8(0x219),_0x1945e7['$'][_0x4f3ed8(0x1e2)][_0x4f3ed8(0x1e5)]=translate_1['tr'](_0x4f3ed8(0x1b1))||_0x4f3ed8(0x1b9),_0x1945e7['$'][_0x4f3ed8(0x1e2)][_0x4f3ed8(0x1e1)](_0x4f3ed8(0x1c2),async()=>{const _0x6e4f50=_0x4f3ed8;_0x1945e7['$'][_0x6e4f50(0x1e2)][_0x6e4f50(0x20e)][_0x6e4f50(0x1f3)]='none',Editor[_0x6e4f50(0x1ea)][_0x6e4f50(0x1ab)]('im-plugin',_0x6e4f50(0x200));})):(_0x1945e7['$'][_0x4f3ed8(0x1e2)]['style'][_0x4f3ed8(0x1f3)]=_0x4f3ed8(0x1d9),_0x1945e7['$'][_0x4f3ed8(0x1e2)][_0x4f3ed8(0x1e8)](_0x4f3ed8(0x1c2),()=>{}));}let that=null;async function ready(){const _0xd2f262=_0x4e8e4a;if(that=this,await controlUpdateBtn(that),forceClose=!0x1,Editor['Panel']['kitControl'],Editor[_0xd2f262(0x1ea)][_0xd2f262(0x1bb)](namespace_1['ns']+_0xd2f262(0x217),forceClosePanel),!await Editor['User'][_0xd2f262(0x1f8)]())return await dialog_1[_0xd2f262(0x1d1)](translate_1['tr'](_0xd2f262(0x21a)),{'title':translate_1['tr'](_0xd2f262(0x1fe)),'buttons':[translate_1['tr']('ok')],'default':0x0}),void Editor['Message'][_0xd2f262(0x1b5)](namespace_1['ns']+_0xd2f262(0x217));this['$'][_0xd2f262(0x1f5)][_0xd2f262(0x1e1)](_0xd2f262(0x1fc),()=>{const _0x35774d=_0xd2f262;Editor[_0x35774d(0x1ea)][_0x35774d(0x1ab)](namespace_1['ns'],_0x35774d(0x1fc));}),this['$']['webview'][_0xd2f262(0x1ee)]('webpreferences','contextIsolation=false'),this['$'][_0xd2f262(0x1f5)][_0xd2f262(0x1ee)](_0xd2f262(0x1cd),file_url_1['default'](path_1['default'][_0xd2f262(0x1bd)](__dirname,_0xd2f262(0x1fa)))),this['$'][_0xd2f262(0x1f5)][_0xd2f262(0x1e1)]('ipc-message',_0x4933b2=>{const _0x510548=_0xd2f262;onIpcMessage(_0x4933b2,this['$'][_0x510548(0x1f5)],this['$']['loadingPage']);});const _0x5d055b=await Editor['Message'][_0xd2f262(0x209)](namespace_1['ns'],_0xd2f262(0x1dd));if(!_0x5d055b)return dialog_1[_0xd2f262(0x1d1)](translate_1['tr'](_0xd2f262(0x1f1)),{'title':translate_1['tr'](_0xd2f262(0x1fe))}),void Editor[_0xd2f262(0x1ea)]['broadcast'](namespace_1['ns']+':force-close-panel');this['$'][_0xd2f262(0x1f5)][_0xd2f262(0x1b2)]=_0x5d055b,this['$'][_0xd2f262(0x1f5)][_0xd2f262(0x1e1)]('new-window',async _0x49d546=>{const _0x4674d9=_0xd2f262;electron_1['shell']['openExternal'](await Editor[_0x4674d9(0x1ea)][_0x4674d9(0x209)](namespace_1['ns'],_0x4674d9(0x204),_0x49d546[_0x4674d9(0x20d)]));}),electron_1[_0xd2f262(0x214)]['on'](ipcFlag+_0xd2f262(0x1db),()=>{const _0x5b8788=_0xd2f262;action=_0x5b8788(0x21b);}),electron_1[_0xd2f262(0x214)]['on'](namespace_1['ns']+_0xd2f262(0x1d5),(_0xdda829,_0x56d50f)=>{const _0x42a424=_0xd2f262;try{this['$']['webview'][_0x42a424(0x1ab)](namespace_1['ns']+_0x42a424(0x1d5),_0x56d50f);}catch(_0x470116){}}),electron_1[_0xd2f262(0x214)][_0xd2f262(0x1ab)](namespace_1['ns']+':panel-ready');}async function beforeClose(_0x35a464={}){const _0x17bcb5=_0x4e8e4a;if(forceClose||_0x35a464['move']||element[_0x17bcb5(0x201)]&&element['panels'][_0x17bcb5(0x1b4)]>0x1)return!0x0;if('refresh'===action)return!0x0;action='refresh';try{return!!await Editor[_0x17bcb5(0x1ea)][_0x17bcb5(0x209)](namespace_1['ns'],'whether-close')||(electron_1[_0x17bcb5(0x214)]['send'](namespace_1['ns']+':hide-panel'),!0x1);}catch(_0x2a5580){return!0x0;}}function close(){const _0x38cd3b=_0x4e8e4a;Editor[_0x38cd3b(0x1ea)][_0x38cd3b(0x1f0)](namespace_1['ns']+_0x38cd3b(0x217),forceClosePanel);}function onIpcMessage(_0x2a01a9,_0x109f58,_0x3f7fc0){const _0x4a99c8=_0x4e8e4a;async function _0x1f252f(_0x12cbec){const _0xb821b1=_0x5050,_0x265adf=_0x2a01a9[_0xb821b1(0x1d3)][0x0][_0xb821b1(0x203)],_0x3b3866=_0x2a01a9[_0xb821b1(0x1d3)][0x0][_0xb821b1(0x1ec)];let _0x4c07a6=null;_0x4c07a6='image'===_0x265adf?{'title':translate_1['tr'](_0xb821b1(0x210)),'path':_0x3b3866,'filters':[{'name':translate_1['tr'](_0xb821b1(0x218)),'extensions':[_0xb821b1(0x1e7),'jpeg',_0xb821b1(0x1e0),'gif']}]}:{'title':translate_1['tr'](_0xb821b1(0x1ff)),'path':_0x3b3866,'filters':[{'name':translate_1['tr'](_0xb821b1(0x1ef)),'extensions':['*']}]};const _0x2b1c48=await dialog_1[_0xb821b1(0x1d4)](_0x4c07a6);if(!_0x2b1c48[_0xb821b1(0x1b7)])return void(_0x12cbec&&_0x109f58['send'](_0xb821b1(0x216),_0x2a01a9[_0xb821b1(0x1d3)][0x0][_0xb821b1(0x1aa)]));const _0x1cef1d=_0x2a01a9['args'][0x0]['url'],_0x514f26=path_1[_0xb821b1(0x1ad)][_0xb821b1(0x1cb)](_0x2b1c48[_0xb821b1(0x1b7)]),_0xba2bce=download_1['default'](_0x1cef1d,_0x514f26,{'filename':path_1[_0xb821b1(0x1ad)][_0xb821b1(0x1b0)](_0x2b1c48['filePath'])});if(_0x12cbec){_0xba2bce['on'](_0xb821b1(0x20a),_0x55d53d=>{const _0x89fe7d=_0xb821b1;_0x109f58[_0x89fe7d(0x1ab)](_0x89fe7d(0x1d6),{'callId':_0x2a01a9[_0x89fe7d(0x1d3)][0x0]['callId'],'percent':_0x55d53d[_0x89fe7d(0x215)],'transferred':_0x55d53d[_0x89fe7d(0x1ce)],'total':_0x55d53d[_0x89fe7d(0x1da)]});});try{await _0xba2bce,_0x109f58[_0xb821b1(0x1ab)](_0xb821b1(0x1ca),_0x2a01a9['args'][0x0]['callId']);}catch(_0x383be8){_0x109f58['send']('download-failed',{'callId':_0x2a01a9['args'][0x0]['callId'],'errorStr':_0x383be8['toString']()});}}}switch(_0x2a01a9[_0x4a99c8(0x208)]){case'new-msg':Editor[_0x4a99c8(0x1ea)][_0x4a99c8(0x1ab)](namespace_1['ns'],_0x4a99c8(0x1c0),{'newMsgCount':_0x2a01a9[_0x4a99c8(0x1d3)][0x0][_0x4a99c8(0x1cc)]});break;case _0x4a99c8(0x1cf):_0x3f7fc0[_0x4a99c8(0x20e)][_0x4a99c8(0x1f3)]='none';break;case _0x4a99c8(0x1c6):_0x1f252f(!0x1);break;case _0x4a99c8(0x1b6):!async function(){const _0x198bbf=_0x4a99c8,_0x1371bd=await function(){const _0x37ffa6=_0x5050;let _0x35363a;return _0x35363a=_0x37ffa6(0x1fb)===_0x2a01a9[_0x37ffa6(0x1d3)][0x0][_0x37ffa6(0x203)]?{'title':translate_1['tr'](_0x37ffa6(0x1c3)),'filters':[{'name':translate_1['tr'](_0x37ffa6(0x218)),'extensions':[_0x37ffa6(0x1e7),_0x37ffa6(0x1df),_0x37ffa6(0x1e0),_0x37ffa6(0x211)]}]}:{'title':translate_1['tr'](_0x37ffa6(0x1b6)),'filters':[{'name':translate_1['tr'](_0x37ffa6(0x1ef)),'extensions':['*']}]},dialog_1[_0x37ffa6(0x1c9)](_0x35363a);}();_0x1371bd[_0x198bbf(0x20c)]?_0x109f58[_0x198bbf(0x1ab)](_0x198bbf(0x1af),''):_0x109f58[_0x198bbf(0x1ab)](_0x198bbf(0x1af),_0x1371bd[_0x198bbf(0x1b3)][0x0]);}();break;case _0x4a99c8(0x1ae):_0x1f252f(!0x0);break;case'request-data':!async function(){const _0x50d9df=_0x4a99c8,_0x1fa554={'entry':'plugin','languageType':Editor[_0x50d9df(0x1f2)][_0x50d9df(0x1ba)](),'osTimeZone':'UTC'+(-new Date()[_0x50d9df(0x1c1)]()>=0x0?'+':'')+-new Date()[_0x50d9df(0x1c1)]()/0x3c+'\x20'+dayjs['tz'][_0x50d9df(0x1dc)](),'dashBoardVersion':process[_0x50d9df(0x205)]['COCOS_DASHBOARD_VERSION'],'creatorVersion':Editor[_0x50d9df(0x1c4)]['version'],'pluginVersion':pluginVersion,'osType':os_1[_0x50d9df(0x1ad)][_0x50d9df(0x203)](),'osVersion':os_1[_0x50d9df(0x1ad)][_0x50d9df(0x1d0)]()};_0x109f58[_0x50d9df(0x1ab)](_0x50d9df(0x202),Object[_0x50d9df(0x1f4)]({},_0x1fa554));}();}}function forceClosePanel(){const _0x518191=_0x4e8e4a;forceClose=!0x0,Editor[_0x518191(0x1ea)][_0x518191(0x1ab)](namespace_1['ns'],_0x518191(0x206));}exports['ready']=ready,exports['beforeClose']=beforeClose,exports['close']=close;const methods={async 'check'(){that&&await controlUpdateBtn(that);}};exports[_0x4e8e4a(0x1d8)]=methods;