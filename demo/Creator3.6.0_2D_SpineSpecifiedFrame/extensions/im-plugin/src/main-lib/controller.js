const _0x2c14=['getInstance','login','onLanguageChanged','electron','../common-lib/update-toolbar','Package','onUserLogout','dispatchLoggedInState','focus','blur','Message','onHidePanel','../constant/namespace','onLoggedInShouldNotShowState','default','getButtonTitle','message','sender','send',':panel-ready','setMenuVisibility','contributions','removeBroadcastListener','__esModule','bind','panel\x20window\x20is\x20undefined','./service','setPanelBlurred','removeListener','cleanImSetting','cleanUp','__importDefault','apply','onNotLoggedInState','minimize','User','updateToolbar','name','join','onUserLogin','instance','addBroadcastListener','restore','../../resources/images/icon.png','hide','logout','Menu','shouldShowEntrance','uninit','fromWebContents','./new-msg-count-timer','init','i18n:change','isLoggedIn','show','path','ipcMain','onClosePanel','info','onPanelReady'];(function(_0x484a2c,_0x31fe0c){const _0x2c1472=function(_0x32063b){while(--_0x32063b){_0x484a2c['push'](_0x484a2c['shift']());}};_0x2c1472(++_0x31fe0c);}(_0x2c14,0x14b));const _0x3206=function(_0x484a2c,_0x31fe0c){_0x484a2c=_0x484a2c-0x162;let _0x2c1472=_0x2c14[_0x484a2c];return _0x2c1472;};const _0x41453b=_0x3206;'use strict';var __importDefault=this&&this[_0x41453b(0x162)]||function(_0x4f681d){const _0x591c54=_0x41453b;return _0x4f681d&&_0x4f681d[_0x591c54(0x196)]?_0x4f681d:{'default':_0x4f681d};};Object['defineProperty'](exports,_0x41453b(0x196),{'value':!0x0});const path_1=__importDefault(require(_0x41453b(0x17a))),electron_1=require(_0x41453b(0x182)),update_toolbar_1=require(_0x41453b(0x183)),namespace_1=require(_0x41453b(0x18b)),new_msg_count_timer_1=__importDefault(require(_0x41453b(0x175))),service_1=__importDefault(require(_0x41453b(0x199))),newMsgCountTimer=new_msg_count_timer_1[_0x41453b(0x18d)][_0x41453b(0x17f)]();class Controller{constructor(){const _0x33b297=_0x41453b;this[_0x33b297(0x16a)]=this['onUserLogin'][_0x33b297(0x197)](this),this[_0x33b297(0x185)]=this[_0x33b297(0x185)][_0x33b297(0x197)](this),this[_0x33b297(0x181)]=this['onLanguageChanged'][_0x33b297(0x197)](this),this['onPanelReady']=this['onPanelReady']['bind'](this);}static[_0x41453b(0x17f)](){const _0x4df7c1=_0x41453b;return this[_0x4df7c1(0x16b)]||(this[_0x4df7c1(0x16b)]=new Controller()),this['instance'];}async[_0x41453b(0x176)](){const _0x18c86b=_0x41453b;Editor[_0x18c86b(0x166)]['on'](_0x18c86b(0x180),this[_0x18c86b(0x16a)]),Editor['User']['on'](_0x18c86b(0x170),this[_0x18c86b(0x185)]),Editor[_0x18c86b(0x189)][_0x18c86b(0x16c)](_0x18c86b(0x177),this[_0x18c86b(0x181)]),electron_1[_0x18c86b(0x17b)]['on'](namespace_1['ns']+_0x18c86b(0x192),this[_0x18c86b(0x17e)]),await Editor[_0x18c86b(0x166)][_0x18c86b(0x178)]()?this[_0x18c86b(0x186)]():(this[_0x18c86b(0x164)](),setTimeout(()=>{this['setMenuVisibility'](!0x1);},0x1f4));}[_0x41453b(0x173)](){const _0x2b33be=_0x41453b;Editor['User'][_0x2b33be(0x19b)](_0x2b33be(0x180),this[_0x2b33be(0x16a)]),Editor[_0x2b33be(0x166)][_0x2b33be(0x19b)](_0x2b33be(0x170),this['onUserLogout']),Editor[_0x2b33be(0x189)][_0x2b33be(0x195)](_0x2b33be(0x177),this[_0x2b33be(0x181)]),electron_1[_0x2b33be(0x17b)][_0x2b33be(0x19b)](namespace_1['ns']+_0x2b33be(0x192),this[_0x2b33be(0x17e)]);}['onShowPanel'](){const _0x3fd44b=_0x41453b;newMsgCountTimer[_0x3fd44b(0x19d)](),update_toolbar_1[_0x3fd44b(0x167)]({'newMsgCount':0x0},!0x0),update_toolbar_1[_0x3fd44b(0x19a)](!0x1);}[_0x41453b(0x18a)](){const _0x9c6e81=_0x41453b;update_toolbar_1[_0x9c6e81(0x19a)](!0x0);}[_0x41453b(0x17c)](){update_toolbar_1['setPanelBlurred'](!0x0);}[_0x41453b(0x16a)](){const _0x474cf7=_0x41453b;this[_0x474cf7(0x186)]();}[_0x41453b(0x185)](){const _0x521bde=_0x41453b;this[_0x521bde(0x164)]();}async[_0x41453b(0x181)](){const _0x3144e8=_0x41453b;await Editor['User'][_0x3144e8(0x178)]()&&this[_0x3144e8(0x186)]();}async[_0x41453b(0x186)](){const _0x34da4c=_0x41453b,_0x2b353f=await service_1['default'][_0x34da4c(0x17f)]();_0x2b353f[_0x34da4c(0x19c)](),await _0x2b353f[_0x34da4c(0x172)]()?this['onLoggedInShouldShowState']():this[_0x34da4c(0x18c)]();}[_0x41453b(0x164)](){const _0x4b0a16=_0x41453b;Editor[_0x4b0a16(0x189)]['broadcast'](namespace_1['ns']+':force-close-panel'),this['setMenuVisibility'](!0x1),update_toolbar_1[_0x4b0a16(0x167)]({'showToolbar':!0x1}),newMsgCountTimer[_0x4b0a16(0x19d)]();}async['onLoggedInShouldShowState'](){const _0x278c38=_0x41453b,_0x332a29=await service_1[_0x278c38(0x18d)][_0x278c38(0x17f)](),_0x1d6cad=await _0x332a29['isVip'](),_0x490de8=await _0x332a29[_0x278c38(0x18e)]();this[_0x278c38(0x193)](!0x0),update_toolbar_1['updateToolbar']({'showToolbar':!0x0,'isVip':_0x1d6cad,'buttonTitle':_0x490de8}),newMsgCountTimer['setUp']();}[_0x41453b(0x18c)](){this['onNotLoggedInState']();}[_0x41453b(0x17e)](_0x47da3e){const _0x81d259=_0x41453b,_0x3fe89c=electron_1['BrowserWindow'][_0x81d259(0x174)](_0x47da3e[_0x81d259(0x190)]);function _0x377acb(_0x4e7940){const _0x1fc741=_0x81d259;_0x47da3e[_0x1fc741(0x190)][_0x1fc741(0x191)](namespace_1['ns']+':panel-win-state-changed',_0x4e7940);}_0x3fe89c?(_0x3fe89c['on'](_0x81d259(0x188),_0x377acb[_0x81d259(0x197)](null,_0x81d259(0x188))),_0x3fe89c['on'](_0x81d259(0x187),_0x377acb['bind'](null,'focus')),_0x3fe89c['on'](_0x81d259(0x179),_0x377acb[_0x81d259(0x197)](null,'show')),_0x3fe89c['on'](_0x81d259(0x16f),_0x377acb['bind'](null,_0x81d259(0x16f))),_0x3fe89c['on']('minimize',_0x377acb[_0x81d259(0x197)](null,_0x81d259(0x165))),_0x3fe89c['on']('restore',_0x377acb[_0x81d259(0x197)](null,_0x81d259(0x16d))),_0x3fe89c['on'](_0x81d259(0x188),()=>{update_toolbar_1['setPanelBlurred'](!0x0);}),_0x3fe89c['on'](_0x81d259(0x187),()=>{const _0x1a6333=_0x81d259;update_toolbar_1[_0x1a6333(0x167)]({'newMsgCount':0x0},!0x0),update_toolbar_1['setPanelBlurred'](!0x1);})):console['error'](_0x81d259(0x198));}[_0x41453b(0x193)](_0x1026e0){const _0x4c0c2c=_0x41453b;var _0x3a2af1;const _0x365eb7=Editor[_0x4c0c2c(0x184)]['getPackages']({'name':namespace_1['ns']}),_0x15a57e=_0x365eb7[_0x365eb7['length']-0x1],_0x62da1d=_0x15a57e[_0x4c0c2c(0x168)],_0x4353c1=null===(_0x3a2af1=_0x15a57e[_0x4c0c2c(0x17d)][_0x4c0c2c(0x194)])||void 0x0===_0x3a2af1?void 0x0:_0x3a2af1['menu'][0x0];_0x4353c1&&(_0x1026e0?Editor[_0x4c0c2c(0x171)]['add'](_0x4353c1[_0x4c0c2c(0x17a)],Object['assign'](Object['assign']({},_0x4353c1),{'icon':path_1['default'][_0x4c0c2c(0x169)](__dirname,_0x4c0c2c(0x16e)),'click':()=>{const _0x38025f=_0x4c0c2c;Editor[_0x38025f(0x189)][_0x38025f(0x191)](_0x62da1d,_0x4353c1[_0x38025f(0x18f)]);}})):Editor[_0x4c0c2c(0x171)]['remove'](_0x4353c1[_0x4c0c2c(0x17a)],_0x4353c1),Editor['Menu'][_0x4c0c2c(0x163)]());}}exports[_0x41453b(0x18d)]=Controller,Controller['instance']=null;